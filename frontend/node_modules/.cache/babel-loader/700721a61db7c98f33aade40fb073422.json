{"remainingRequest":"/var/www/frontend/node_modules/thread-loader/dist/cjs.js!/var/www/frontend/node_modules/babel-loader/lib/index.js!/var/www/frontend/src/main.js","dependencies":[{"path":"/var/www/frontend/src/main.js","mtime":1549555905043},{"path":"/var/www/frontend/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/var/www/frontend/node_modules/thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/var/www/frontend/node_modules/babel-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import _JSON$stringify from \"/var/www/frontend/node_modules/@babel/runtime-corejs2/core-js/json/stringify\";\nimport _Promise from \"/var/www/frontend/node_modules/@babel/runtime-corejs2/core-js/promise\";\nimport \"core-js/modules/es6.array.iterator\";\nimport \"core-js/modules/es6.promise\";\nimport \"core-js/modules/es7.promise.finally\";\nimport Vue from 'vue';\nimport BootstrapVue from 'bootstrap-vue';\nimport App from './App.vue';\nimport router from './router';\nimport store from './store';\nimport axios from 'axios';\nVue.config.productionTip = false; //берем настройки из файла .env.local\n\naxios.defaults.baseURL = process.env.VUE_APP_API_URL;\nvar user = JSON.parse(localStorage.getItem('user'));\n\nif (user) {\n  axios.defaults.headers.common['Authorization'] = 'Bearer ' + user.access_token;\n}\n\naxios.interceptors.response.use(null, function (error) {\n  if (!error.response || error.response.status !== 401) {\n    return _Promise.reject(error);\n  }\n\n  var request = error.config;\n\n  if (request.data) {\n    var data = JSON.parse(request.data);\n\n    if (data && data.grant_type) {\n      return _Promise.reject(error);\n    }\n  }\n\n  return store.dispatch('refresh').then(function () {\n    return new _Promise(function (resolve) {\n      request.headers['Authorization'] = 'Bearer ' + store.state.user.access_token;\n      resolve(axios(request));\n    });\n  }).catch(function () {\n    router.push({\n      name: 'login'\n    });\n    return _Promise.reject(error);\n  });\n}); //работа с websocket\n\nvar socket = new WebSocket(process.env.VUE_APP_WS_URL);\n\nsocket.onopen = function (e) {\n  console.log('ws open on server --- %s', e.target.url);\n\n  if (user) {\n    socket.send(_JSON$stringify({\n      type: 'auth',\n      token: user.access_token\n    }));\n  }\n};\n\nsocket.onmessage = function (event) {\n  var data = JSON.parse(event.data);\n  console.log(data);\n\n  if (data.type === 'notification') {\n    store.commit('addNotification', data.message);\n  }\n}; //vue использует компонент внутри себя\n\n\nVue.use(BootstrapVue);\nnew Vue({\n  router: router,\n  store: store,\n  render: function render(h) {\n    return h(App);\n  }\n}).$mount('#app');",{"version":3,"sources":["/var/www/frontend/src/main.js"],"names":["Vue","BootstrapVue","App","router","store","axios","config","productionTip","defaults","baseURL","process","env","VUE_APP_API_URL","user","JSON","parse","localStorage","getItem","headers","common","access_token","interceptors","response","use","error","status","reject","request","data","grant_type","dispatch","then","resolve","state","catch","push","name","socket","WebSocket","VUE_APP_WS_URL","onopen","e","console","log","target","url","send","type","token","onmessage","event","commit","message","render","h","$mount"],"mappings":"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","sourcesContent":["import Vue from 'vue'\nimport BootstrapVue from 'bootstrap-vue'\nimport App from './App.vue'\nimport router from './router'\nimport store from './store'\nimport axios from 'axios'\n\nVue.config.productionTip = false;\n\n//берем настройки из файла .env.local\naxios.defaults.baseURL = process.env.VUE_APP_API_URL;\n\nconst user = JSON.parse(localStorage.getItem('user'));\nif (user) {\n    axios.defaults.headers.common['Authorization'] = 'Bearer ' + user.access_token;\n}\n\naxios.interceptors.response.use(null, error => {\n    if (!error.response || error.response.status !== 401) {\n    return Promise.reject(error);\n}\nconst request = error.config;\nif (request.data) {\n    let data = JSON.parse(request.data);\n    if (data && data.grant_type) {\n        return Promise.reject(error);\n    }\n}\nreturn store.dispatch('refresh')\n    .then(() => {\n    return new Promise((resolve) => {\n        request.headers['Authorization'] = 'Bearer ' + store.state.user.access_token;\nresolve(axios(request))\n})\n})\n.catch(() => {\n    router.push({name: 'login'});\nreturn Promise.reject(error)\n});\n});\n//работа с websocket\nconst socket = new WebSocket(process.env.VUE_APP_WS_URL);\n\nsocket.onopen = function(e) {\n    console.log('ws open on server --- %s',e.target.url);\n    if (user) {\n        socket.send(JSON.stringify({\n            type: 'auth',\n            token: user.access_token\n        }));\n    }\n};\n\nsocket.onmessage = function(event) {\n    let data = JSON.parse(event.data);\n    console.log(data);\n    if (data.type === 'notification') {\n        store.commit('addNotification', data.message);\n    }\n};\n//vue использует компонент внутри себя\nVue.use(BootstrapVue);\n\nnew Vue({\n  router,\n  store,\n  render: h => h(App)\n}).$mount('#app')\n"]}]}